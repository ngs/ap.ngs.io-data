name: Follow / Unfollow

on:
  workflow_dispatch:
    inputs:
      action:
        description: 'Action to perform'
        required: true
        type: choice
        options:
          - follow
          - unfollow
      account:
        description: 'Account handle (e.g., ngs)'
        required: true
        type: string
      target:
        description: 'Target user (e.g., user@mastodon.social)'
        required: true
        type: string

jobs:
  execute:
    runs-on: ubuntu-latest
    steps:
      - name: ${{ inputs.action }} @${{ inputs.target }}
        run: |
          curl -sf -X POST "https://ap.ngs.io/admin/${{ inputs.action }}" \
            -H "Authorization: Bearer ${{ secrets.ADMIN_TOKEN }}" \
            -H "Content-Type: application/json" \
            -d '{"account": "${{ inputs.account }}", "target": "${{ inputs.target }}"}'
          echo "Successfully executed ${{ inputs.action }} for @${{ inputs.target }}"
